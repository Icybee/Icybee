(function(){function h(a){var c,b=Math.max(f+a.client.y-g,100);c="IFRAME"==e.tagName?e.getNext():e.getPrevious(),e.setStyle("height",b),c.setStyle("height",b)}function i(){window.removeEvent("mousemove",h),window.removeEvent("mouseup",i),"IFRAME"==e.tagName&&e.setStyle("visibility",""),e=null}var a=/^(H[1-6]|HR|P|DIV|ADDRESS|PRE|FORM|TABLE|LI|OL|UL|TD|CAPTION|BLOCKQUOTE|CENTER|DL|DT|DD|SCRIPT|NOSCRIPT|STYLE|ARTICLE|ASIDE|DETAILS|FIGCAPTION|FIGURE|FOOTER|HEADER|HGROUP|NAV)$/i,b=/^(https?|ftp|rmtp|mms):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)(:(\d+))?\/?/i,c=/<(script|noscript|style)[\u0000-\uFFFF]*?<\/(script|noscript|style)>/g;this.MooEditable=new Class({Implements:[Events,Options],options:{toolbar:!0,cleanup:!0,paragraphise:!0,xhtml:!0,semantics:!0,actions:"bold italic underline strikethrough | insertunorderedlist insertorderedlist indent outdent | undo redo | createlink unlink | urlimage | toggleview",handleSubmit:!0,handleLabel:!0,disabled:!1,baseCSS:"html{ height: 100%; cursor: text; } body{ font-family: sans-serif; }",extraCSS:"",externalCSS:"",html:'<!DOCTYPE html><html id="{HTMLID}" lang="{LANGUAGE}"><head><meta charset="UTF-8">{BASEHREF}<style>{BASECSS} {EXTRACSS}</style>{EXTERNALCSS}</head><body></body></html>',rootElement:"p",baseURL:"",dimensions:null,htmlId:"wysiwyg"},initialize:function(a,b){("contentEditable"in document.body||"designMode"in document)&&(this.setOptions(b),this.textarea=document.id(a),this.textarea.store("MooEditable",this),this.actions=this.options.actions.clean().split(" "),this.keys={},this.dialogs={},this.protectedElements=[],this.actions.each(function(a){var b=MooEditable.Actions[a];if(b){if(b.options){var c=b.options.shortcut;c&&(this.keys[c]=a)}b.dialogs&&Object.each(b.dialogs,function(b,c){b=b.attempt(this),b.name=a+":"+c,"object"!=typeOf(this.dialogs[a])&&(this.dialogs[a]={}),this.dialogs[a][c]=b},this),b.events&&Object.each(b.events,function(a,b){this.addEvent(b,a)},this)}}.bind(this)),this.render())},toElement:function(){return this.textarea},render:function(){var a=this,b=this.options.dimensions||this.textarea.getSize();this.container=new Element("div",{id:this.textarea.id?this.textarea.id+"-mooeditable-container":null,"class":"mooeditable-container"}),this.textarea.addClass("mooeditable-textarea").setStyle("height",b.y),this.iframe=new IFrame({"class":"mooeditable-iframe",frameBorder:0,src:'javascript:""',styles:{height:Math.max(100,b.y)}}),this.resizer=new Element("div.mooeditable-resizer"),this.toolbar=new MooEditable.UI.Toolbar({onItemAction:function(){var b=Array.from(arguments),c=b[0];a.action(c.name,b)}}),this.attach.delay(1,this),this.options.handleLabel&&this.textarea.id&&$$('label[for="'+this.textarea.id+'"]').addEvent("click",function(b){"iframe"==a.mode&&(b.preventDefault(),a.focus())}),this.options.handleSubmit&&(this.form=this.textarea.getParent("form"),this.form&&this.form.addEvent("submit",function(){"iframe"==a.mode&&a.saveContent()})),this.fireEvent("render",this)},attach:function(){var a=this;this.mode="iframe",this.editorDisabled=!1,this.container.wraps(this.textarea),this.textarea.setStyle("display","none"),this.iframe.setStyle("display","").inject(this.textarea,"before"),this.resizer.inject(this.textarea,"after"),Object.each(this.dialogs,function(b,c){Object.each(b,function(b){document.id(b).inject(a.iframe,"before");var d;b.addEvents({open:function(){d=a.selection.getRange(),a.editorDisabled=!0,a.toolbar.disable(c),a.fireEvent("dialogOpen",this)},close:function(){a.toolbar.enable(),a.editorDisabled=!1,a.focus(),d&&a.selection.setRange(d),a.fireEvent("dialogClose",this)}})})}),this.win=this.iframe.contentWindow,this.doc=this.win.document,Browser.firefox&&(this.doc.designMode="On");var b="";this.options.externalCSS&&("array"==typeOf(this.options.externalCSS)?this.options.externalCSS.each(function(a){b+='<link rel="stylesheet" href="'+a+'">\n'}):b='<link rel="stylesheet" href="'+this.options.externalCSS+'">'),this.baseHREF=document.location.protocol+"//"+document.location.hostname;var c=this.options.html.substitute({BASECSS:this.options.baseCSS,EXTRACSS:this.options.extraCSS,EXTERNALCSS:b,BASEHREF:'<base href="'+this.baseHREF+'" />',HTMLID:this.options.htmlId,LANGUAGE:this.textarea.get("lang")||document.html.get("lang")});if(this.doc.open(),this.doc.write(c),this.doc.close(),Browser.ie?this.doc.body.contentEditable=!0:this.doc.designMode="On",Object.append(this.win,new Window),Object.append(this.doc,new Document),Browser.Element){var d=this.win.Element.prototype;for(var e in Element)e.test(/^[A-Z]|\$|prototype|mooEditable/)||(d[e]=Element.prototype[e])}else document.id(this.doc.body);if(this.setContent(this.textarea.get("value")),this.doc.addEvents({mouseup:this.editorMouseUp.bind(this),mousedown:this.editorMouseDown.bind(this),mouseover:this.editorMouseOver.bind(this),mouseout:this.editorMouseOut.bind(this),mouseenter:this.editorMouseEnter.bind(this),mouseleave:this.editorMouseLeave.bind(this),contextmenu:this.editorContextMenu.bind(this),click:this.editorClick.bind(this),dblclick:this.editorDoubleClick.bind(this),keypress:this.editorKeyPress.bind(this),keyup:this.editorKeyUp.bind(this),keydown:this.editorKeyDown.bind(this),focus:this.editorFocus.bind(this),blur:this.editorBlur.bind(this)}),this.win.addEvents({focus:this.editorFocus.bind(this),blur:this.editorBlur.bind(this),load:function(){this.actions.each(function(a){var b=MooEditable.Actions[a];b&&b.load&&b.load(this)},this)}.bind(this)}),["cut","copy","paste"].each(function(b){a.doc.body.addListener(b,a["editor"+b.capitalize()].bind(a))}),this.textarea.addEvent("keypress",this.textarea.retrieve("mooeditable:textareaKeyListener",this.keyListener.bind(this))),Browser.firefox2&&this.doc.addEvent("focus",function(){a.win.fireEvent("focus").focus()}),this.doc.addEventListener&&this.doc.addEventListener("focus",function(){a.win.fireEvent("focus")},!0),!Browser.ie&&!Browser.opera){var f=function(){a.execute("styleWithCSS",!1,!1),a.doc.removeEvent("focus",f)};this.win.addEvent("focus",f)}return this.options.toolbar&&(document.id(this.toolbar).inject(this.container,"top"),this.toolbar.render(this.actions)),this.options.disabled&&this.disable(),this.selection=new MooEditable.Selection(this.win),this.oldContent=this.getContent(),this.fireEvent("attach",this),this},detach:function(){return this.saveContent(),this.textarea.setStyle("display","").removeClass("mooeditable-textarea").inject(this.container,"before"),this.textarea.removeEvent("keypress",this.textarea.retrieve("mooeditable:textareaKeyListener")),this.container.dispose(),this.fireEvent("detach",this),this},enable:function(){return this.editorDisabled=!1,this.toolbar.enable(),this},disable:function(){return this.editorDisabled=!0,this.toolbar.disable(),this},editorFocus:function(a){this.oldContent="",this.fireEvent("editorFocus",[a,this])},editorBlur:function(a){this.oldContent=this.saveContent().getContent(),this.fireEvent("editorBlur",[a,this])},editorMouseUp:function(a){return this.editorDisabled?(a.stop(),void 0):(this.options.toolbar&&this.checkStates(),this.fireEvent("editorMouseUp",[a,this]),void 0)},editorMouseDown:function(a){return this.editorDisabled?(a.stop(),void 0):(this.fireEvent("editorMouseDown",[a,this]),void 0)},editorMouseOver:function(a){return this.editorDisabled?(a.stop(),void 0):(this.fireEvent("editorMouseOver",[a,this]),void 0)},editorMouseOut:function(a){return this.editorDisabled?(a.stop(),void 0):(this.fireEvent("editorMouseOut",[a,this]),void 0)},editorMouseEnter:function(a){return this.editorDisabled?(a.stop(),void 0):(this.fireEvent("editorMouseEnter",[a,this]),void 0)},editorMouseLeave:function(a){return this.editorDisabled?(a.stop(),void 0):(this.fireEvent("editorMouseLeave",[a,this]),void 0)},editorContextMenu:function(a){return this.editorDisabled?(a.stop(),void 0):(this.fireEvent("editorContextMenu",[a,this]),void 0)},editorClick:function(a){if(Browser.safari||Browser.chrome){var b=a.target;"img"==Element.get(b,"tag")&&(this.options.baseURL&&-1==b.getProperty("src").indexOf("http://")&&b.setProperty("src",this.options.baseURL+b.getProperty("src")),this.selection.selectNode(b),this.checkStates())}this.fireEvent("editorClick",[a,this])},editorDoubleClick:function(a){this.fireEvent("editorDoubleClick",[a,this])},editorKeyPress:function(a){return this.editorDisabled?(a.stop(),void 0):(this.keyListener(a),this.fireEvent("editorKeyPress",[a,this]),void 0)},editorKeyUp:function(a){if(this.editorDisabled)return a.stop(),void 0;var b=a.code;this.options.toolbar&&(/^enter|left|up|right|down|delete|backspace$/i.test(a.key)||b>=33&&36>=b||45==b||a.meta||a.control)&&(Browser.ie6?(clearTimeout(this.checkStatesDelay),this.checkStatesDelay=this.checkStates.delay(500,this)):this.checkStates()),this.fireEvent("editorKeyUp",[a,this])},editorKeyDown:function(b){if(this.editorDisabled)return b.stop(),void 0;if("enter"==b.key)if(this.options.paragraphise){if(b.shift&&(Browser.safari||Browser.chrome)){var c=this.selection,d=c.getRange(),e=this.doc.createElement("br");if(d.insertNode(e),d.setStartAfter(e),d.setEndAfter(e),c.setRange(d),c.getSelection().focusNode==e.previousSibling){var f=this.doc.createTextNode(" "),g=e.parentNode,h=e.nextSibling;h?g.insertBefore(f,h):g.appendChild(f),c.selectNode(f),c.collapse(1)}this.win.scrollTo(0,Element.getOffsets(c.getRange().startContainer).y),b.preventDefault()}else if(Browser.firefox||Browser.safari||Browser.chrome){var i=this.selection.getNode(),j=Element.getParents(i).include(i).some(function(b){return b.nodeName.test(a)});j||this.execute("insertparagraph")}}else if(Browser.ie){var d=this.selection.getRange(),i=this.selection.getNode();d&&"li"!=i.get("tag")&&(this.selection.insertContent("<br>"),this.selection.collapse(!1)),b.preventDefault()}if(Browser.opera){var k=b.control||b.meta;k&&"x"==b.key?this.fireEvent("editorCut",[b,this]):k&&"c"==b.key?this.fireEvent("editorCopy",[b,this]):(k&&"v"==b.key||b.shift&&45==b.code)&&this.fireEvent("editorPaste",[b,this])}this.fireEvent("editorKeyDown",[b,this])},editorCut:function(a){return this.editorDisabled?(a.stop(),void 0):(this.fireEvent("editorCut",[a,this]),void 0)},editorCopy:function(a){return this.editorDisabled?(a.stop(),void 0):(this.fireEvent("editorCopy",[a,this]),void 0)},editorPaste:function(a){return this.editorDisabled?(a.stop(),void 0):(this.fireEvent("editorPaste",[a,this]),void 0)},keyListener:function(a){var b=Browser.Platform.mac?a.meta:a.control;if(b&&this.keys[a.key]){a.preventDefault();var c=this.toolbar.getItem(this.keys[a.key]);c.action(a)}},focus:function(){return("iframe"==this.mode?this.win:this.textarea).focus(),this.fireEvent("focus",this),this},action:function(a,b){var c=MooEditable.Actions[a];c.command&&"function"==typeOf(c.command)?c.command.apply(this,b):(this.focus(),this.execute(a,!1,b),"iframe"==this.mode&&this.checkStates())},execute:function(a,b,c){return this.busy?void 0:(this.busy=!0,this.doc.execCommand(a,b,c),this.saveContent(),this.busy=!1,!1)},toggleView:function(){return this.fireEvent("beforeToggleView",this),"textarea"==this.mode?(this.mode="iframe",this.iframe.setStyle("display",""),this.setContent(this.textarea.value),this.textarea.setStyle("display","none")):(this.saveContent(),this.mode="textarea",this.textarea.setStyle("display",""),this.textarea.setStyle("visibility","visible"),this.iframe.setStyle("display","none")),this.fireEvent("toggleView",this),this.focus.delay(10,this),this},getContent:function(){var a=this.protectedElements,b=this.doc.body.get("html").replace(/<!-- mooeditable:protect:([0-9]+) -->/g,function(b,c){return a[c.toInt()]});return this.cleanup(this.ensureRootElement(b))},setContent:function(a){var b=this.protectedElements;return a=a.replace(c,function(a){return b.push(a),"<!-- mooeditable:protect:"+(b.length-1)+" -->"}),a=a.replace(/src="([^"]+)/gi,function(a,b){return b.match(/^http:\/\//)||("/"!=b[0]&&(b="/"+b),b=this.baseHREF+b),'src="'+b}.bind(this)),this.doc.body.set("html",this.ensureRootElement(a)),this},saveContent:function(){var a;return a="iframe"==this.mode?this.getContent():this.textearea.innerHTML,a=a.replace(RegExp('="'+this.baseHREF,"gi"),'="'),this.textarea.set("value",a),this},ensureRootElement:function(b){if(this.options.rootElement){for(var c=new Element("div",{html:b.trim()}),d=-1,e=!1,f="",g=c.childNodes.length,h=0;g>h;h++){var i=c.childNodes[h],j=i.nodeName;if(j.test(a)||"#comment"===j?e=!0:"#text"===j?i.nodeValue.trim()&&(0>d&&(d=h),f+=i.nodeValue):(0>d&&(d=h),f+=new Element("div").adopt($(i).clone()).get("html")),h==g-1&&(e=!0),d>=0&&e){var k=new Element(this.options.rootElement,{html:f});c.replaceChild(k,c.childNodes[d]);for(var l=d+1;h>l;l++)c.removeChild(c.childNodes[l]),g--,h--,l--;d=-1,e=!1,f=""}}b=c.get("html").replace(/\n\n/g,"")}return b},checkStates:function(){var b=this.selection.getNode();b&&"element"==typeOf(b)&&this.actions.each(function(c){var d=this.toolbar.getItem(c);if(d){d.deactivate();var e=MooEditable.Actions[c].states;if(e){if("function"==typeOf(e))return e.attempt([document.id(b),d],this),void 0;try{if(this.doc.queryCommandState(c))return d.activate(),void 0}catch(f){}if(e.tags){var g=b;do{var h=g.tagName.toLowerCase();if(e.tags.contains(h)){d.activate(h);break}}while(null!=(g=Element.getParent(g)))}if(e.css){var g=b;do{var i=!1;for(var j in e.css){var k=e.css[j];g.style[j.camelCase()].contains(k)&&(d.activate(k),i=!0)}if(i||g.tagName.test(a))break}while(null!=(g=Element.getParent(g)))}}}}.bind(this))},cleanup:function(a){if(!this.options.cleanup)return a.trim();do{var b=a;this.options.baseURL&&(a=a.replace('="'+this.options.baseURL,'="/')),a=a.replace(/<br class\="webkit-block-placeholder">/gi,"<br />"),a=a.replace(/<span class="Apple-style-span">(.*)<\/span>/gi,"$1"),a=a.replace(/ class="Apple-style-span"/gi,""),a=a.replace(/<span style="">/gi,""),a=a.replace(/<p>\s*<br ?\/?>\s*<\/p>/gi,"<p> </p>"),a=a.replace(/<p>(&nbsp;|\s)*<\/p>/gi,"<p> </p>"),this.options.semantics||(a=a.replace(/\s*<br ?\/?>\s*<\/p>/gi,"</p>")),this.options.xhtml&&(a=a.replace(/<br>/gi,"<br />")),this.options.semantics&&(Browser.ie&&(a=a.replace(/<li>\s*<div>(.+?)<\/div><\/li>/g,"<li>$1</li>")),(Browser.safari||Browser.chrome)&&(a=a.replace(/^([\w\s]+.*?)<div>/i,"<p>$1</p><div>"),a=a.replace(/<div>(.+?)<\/div>/gi,"<p>$1</p>")),Browser.ie||(a=a.replace(/<p>[\s\n]*(<(?:ul|ol)>.*?<\/(?:ul|ol)>)(.*?)<\/p>/gi,"$1<p>$2</p>"),a=a.replace(/<\/(ol|ul)>\s*(?!<(?:p|ol|ul|img).*?>)((?:<[^>]*>)?\w.*)$/g,"</$1><p>$2</p>")),a=a.replace(/<br[^>]*><\/p>/g,"</p>"),a=a.replace(/<p([^>]*)>(.*?)<\/p>(?!\n)/g,"<p$1>$2</p>\n"),a=a.replace(/<\/(ul|ol|p)>(?!\n)/g,"</$1>\n"),a=a.replace(/><li>/g,">\n	<li>"),a=a.replace(/([^\n])<\/(ol|ul)>/g,"$1\n</$2>"),a=a.replace(/([^\n])<img/gi,"$1\n<img"),a=a.replace(/^\s*$/g,"")),a=a.replace(/<br ?\/?>$/gi,""),a=a.replace(/^<br ?\/?>/gi,""),this.options.paragraphise&&(a=a.replace(/(h[1-6]|p|div|address|pre|li|ol|ul|blockquote|center|dl|dt|dd)><br ?\/?>/gi,"$1>")),a=a.replace(/<br ?\/?>\s*<\/(h1|h2|h3|h4|h5|h6|li|p)/gi,"</$1"),a=a.replace(/<span style="font-weight: bold;">(.*)<\/span>/gi,"<strong>$1</strong>"),a=a.replace(/<span style="font-style: italic;">(.*)<\/span>/gi,"<em>$1</em>"),a=a.replace(/<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1</strong>"),a=a.replace(/<i\b[^>]*>(.*?)<\/i[^>]*>/gi,"<em>$1</em>"),a=a.replace(/<u\b[^>]*>(.*?)<\/u[^>]*>/gi,'<span style="text-decoration: underline;">$1</span>'),a=a.replace(/<strong><span style="font-weight: normal;">(.*)<\/span><\/strong>/gi,"$1"),a=a.replace(/<em><span style="font-weight: normal;">(.*)<\/span><\/em>/gi,"$1"),a=a.replace(/<span style="text-decoration: underline;"><span style="font-weight: normal;">(.*)<\/span><\/span>/gi,"$1"),a=a.replace(/<strong style="font-weight: normal;">(.*)<\/strong>/gi,"$1"),a=a.replace(/<em style="font-weight: normal;">(.*)<\/em>/gi,"$1"),a=a.replace(/<[^> ]*/g,function(a){return a.toLowerCase()}),a=a.replace(/<[^>]*>/g,function(a){return a=a.replace(/ [^=]+=/g,function(a){return a.toLowerCase()})}),a=a.replace(/<[^!][^>]*>/g,function(a){return a=a.replace(/( [^=]+=)([^"][^ >]*)/g,'$1"$2"')}),this.options.xhtml&&(a=a.replace(/<img([^>]+)(\s*[^\/])>(<\/img>)*/gi,"<img$1$2 />")),a=a.replace(/<p>(?:\s*)<p>/g,"<p>"),a=a.replace(/<\/p>\s*<\/p>/g,"</p>"),a=a.replace(/<pre[^>]*>.*?<\/pre>/gi,function(a){return a.replace(/<br ?\/?>/gi,"\n")}),a=a.trim()}while(a!=b);return a=this.cleanHtml(a)}}),MooEditable.Selection=new Class({initialize:function(a){this.win=a},getSelection:function(){return this.win.focus(),this.win.getSelection?this.win.getSelection():this.win.document.selection},getRange:function(){var a=this.getSelection();if(!a)return null;try{return a.rangeCount>0?a.getRangeAt(0):a.createRange?a.createRange():null}catch(b){return this.doc.body.createTextRange()}},setRange:function(a){if(a.select)Function.attempt(function(){a.select()});else{var b=this.getSelection();b.addRange&&(b.removeAllRanges(),b.addRange(a))}},selectNode:function(a,b){var c=this.getRange(),d=this.getSelection();return c.moveToElementText?Function.attempt(function(){c.moveToElementText(a),c.select()}):d.addRange?(b?c.selectNodeContents(a):c.selectNode(a),d.removeAllRanges(),d.addRange(c)):d.setBaseAndExtent(a,0,a,1),a},isCollapsed:function(){var a=this.getRange();return a.item?!1:0==a.boundingWidth||this.getSelection().isCollapsed},collapse:function(a){var b=this.getRange(),c=this.getSelection();b.select?(b.collapse(a),b.select()):a?c.collapseToStart():c.collapseToEnd()},getContent:function(){var a=this.getRange(),b=new Element("body");if(this.isCollapsed())return"";a.cloneContents?b.appendChild(a.cloneContents()):void 0!=a.item||void 0!=a.htmlText?b.set("html",a.item?a.item(0).outerHTML:a.htmlText):b.set("html",""+a);var c=b.get("html");return c},getText:function(){var a=this.getRange(),b=this.getSelection();return this.isCollapsed()?"":a.text||(b.toString?""+b:"")},getNode:function(){var a=this.getRange();if(!Browser.ie||Browser.version>=9){var b=null;if(a)for(b=a.commonAncestorContainer,a.collapsed||a.startContainer==a.endContainer&&2>a.startOffset-a.endOffset&&a.startContainer.hasChildNodes()&&(b=a.startContainer.childNodes[a.startOffset]);"element"!=typeOf(b);)b=b.parentNode;return document.id(b)}return document.id(a.item?a.item(0):a.parentElement())},insertContent:function(a){if(Browser.ie){var b=this.getRange();if(b.pasteHTML)b.pasteHTML(a),b.collapse(!1),b.select();else if(b.insertNode)if(b.deleteContents(),b.createContextualFragment)b.insertNode(b.createContextualFragment(a));else{var c=this.win.document,d=c.createDocumentFragment(),e=c.createElement("div");d.appendChild(e),e.outerHTML=a,b.insertNode(d)}}else this.win.document.execCommand("insertHTML",!1,a)}});var d={};MooEditable.Locale={define:function(a,b){return"null"!=typeOf(window.Locale)?Locale.define("en-US","MooEditable",a,b):("object"==typeOf(a)?Object.merge(d,a):d[a]=b,void 0)},get:function(a){return"null"!=typeOf(window.Locale)?Locale.get("MooEditable."+a):a?d[a]:""}},MooEditable.Locale.define({ok:"OK",cancel:"Cancel",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",unorderedList:"Unordered List",orderedList:"Ordered List",indent:"Indent",outdent:"Outdent",undo:"Undo",redo:"Redo",removeHyperlink:"Remove Hyperlink",addHyperlink:"Add Hyperlink",selectTextHyperlink:"Please select the text you wish to hyperlink.",enterURL:"Enter URL",enterImageURL:"Enter image URL",addImage:"Add Image",toggleView:"Toggle View"}),MooEditable.UI={},MooEditable.UI.Toolbar=new Class({Implements:[Events,Options],options:{"class":""},initialize:function(a){this.setOptions(a),this.el=new Element("div",{"class":"mooeditable-ui-toolbar "+this.options["class"]}),this.items={},this.content=null},toElement:function(){return this.el},render:function(a){return this.content?this.el.adopt(this.content):this.content=a.map(function(a){return"|"==a?this.addSeparator():"/"==a?this.addLineSeparator():this.addItem(a)}.bind(this)),this},addItem:function(a){var b=this,c=MooEditable.Actions[a];if(c){var d=c.type||"button",e=c.options||{},f=new(MooEditable.UI[d.camelCase().capitalize()])(Object.append(e,{name:a,"class":a+"-item toolbar-item",title:c.title,onAction:b.itemAction.bind(b),tabindex:-1}));return this.items[a]=f,document.id(f).inject(this.el),f}},getItem:function(a){return this.items[a]},addSeparator:function(){return new Element("span.toolbar-separator").inject(this.el)},addLineSeparator:function(){return new Element("div.toolbar-line-separator").inject(this.el)},itemAction:function(){this.fireEvent("itemAction",arguments)},disable:function(a){return Object.each(this.items,function(b){b.name==a?b.activate():b.deactivate().disable()}),this},enable:function(){return Object.each(this.items,function(a){a.enable()}),this},show:function(){return this.el.setStyle("display",""),this},hide:function(){return this.el.setStyle("display","none"),this}}),MooEditable.UI.Button=new Class({Implements:[Events,Options],options:{title:"",name:"",text:"Button","class":"",shortcut:"",mode:"icon"},initialize:function(a){this.setOptions(a),this.name=this.options.name,this.render()},toElement:function(){return this.el},render:function(){var a=this,b=Browser.Platform.mac?"Cmd":"Ctrl",c=this.options.shortcut?" ( "+b+"+"+this.options.shortcut.toUpperCase()+" )":"",d=this.options.title||name,e=d+c;return this.el=new Element("button",{"class":"mooeditable-ui-button "+a.options["class"],title:e,tabindex:-1,html:'<span class="button-icon"></span><span class="button-text">'+d+"</span>",events:{click:a.click.bind(a),mousedown:function(a){a.preventDefault()}}}),"icon"!=this.options.mode&&this.el.addClass("mooeditable-ui-button-"+this.options.mode),this.active=!1,this.disabled=!1,Browser.ie&&this.el.addEvents({mouseenter:function(){this.addClass("hover")},mouseleave:function(){this.removeClass("hover")}}),this},click:function(a){a.preventDefault(),this.disabled||this.action(a)},action:function(){this.fireEvent("action",[this].concat(Array.from(arguments)))},enable:function(){return this.active&&this.el.removeClass("onActive"),this.disabled?(this.disabled=!1,this.el.removeClass("disabled").set({disabled:!1,opacity:1}),this):void 0},disable:function(){return this.disabled?void 0:(this.disabled=!0,this.el.addClass("disabled").set({disabled:!0,opacity:.4}),this)},activate:function(){return this.disabled?void 0:(this.active=!0,this.el.addClass("onActive"),this)},deactivate:function(){return this.active=!1,this.el.removeClass("onActive"),this}}),MooEditable.UI.Dialog=new Class({Implements:[Events,Options],options:{"class":"",contentClass:""},initialize:function(a,b){this.setOptions(b),this.html=a;var c=this;this.el=new Element("div",{"class":"mooeditable-ui-dialog "+c.options["class"],html:'<div class="dialog-content '+c.options.contentClass+'">'+a+"</div>",styles:{display:"none"},events:{click:c.click.bind(c)}})},toElement:function(){return this.el},click:function(){return this.fireEvent("click",arguments),this},open:function(){return this.el.setStyle("display",""),this.fireEvent("open",this),this},close:function(){return this.el.setStyle("display","none"),this.fireEvent("close",this),this}}),MooEditable.UI.AlertDialog=function(a){if(a){var b=a+' <button class="dialog-ok-button">'+MooEditable.Locale.get("ok")+"</button>";return new MooEditable.UI.Dialog(b,{"class":"mooeditable-alert-dialog",onOpen:function(){var a=this.el.getElement(".dialog-ok-button");(function(){a.focus()}).delay(10)},onClick:function(a){a.preventDefault(),"button"==a.target.tagName.toLowerCase()&&document.id(a.target).hasClass("dialog-ok-button")&&this.close()}})}},MooEditable.UI.PromptDialog=function(a,b,c){if(a){var d='<label class="dialog-label">'+a+' <input type="text" class="text dialog-input" value="'+b+'">'+'</label> <button class="dialog-button dialog-ok-button">'+MooEditable.Locale.get("ok")+"</button>"+'<button class="dialog-button dialog-cancel-button">'+MooEditable.Locale.get("cancel")+"</button>";return new MooEditable.UI.Dialog(d,{"class":"mooeditable-prompt-dialog",onOpen:function(){var a=this.el.getElement(".dialog-input");(function(){a.focus(),a.select()}).delay(10)},onClick:function(a){if(a.preventDefault(),"button"==a.target.tagName.toLowerCase()){var d=document.id(a.target),e=this.el.getElement(".dialog-input");if(d.hasClass("dialog-cancel-button"))e.set("value",b),this.close();else if(d.hasClass("dialog-ok-button")){var f=e.get("value");e.set("value",b),this.close(),c&&c.attempt(f,this)}}}})}},MooEditable.Actions={bold:{title:MooEditable.Locale.get("bold"),options:{shortcut:"b"},states:{tags:["b","strong"],css:{"font-weight":"bold"}},events:{beforeToggleView:function(){if(Browser.firefox){var a=this.textarea.get("value"),b=a.replace(/<strong([^>]*)>/gi,"<b$1>").replace(/<\/strong>/gi,"</b>");a!=b&&this.textarea.set("value",b)}},attach:function(){if(Browser.firefox){var a=this.textarea.get("value"),b=a.replace(/<strong([^>]*)>/gi,"<b$1>").replace(/<\/strong>/gi,"</b>");a!=b&&(this.textarea.set("value",b),this.setContent(b))}}}},italic:{title:MooEditable.Locale.get("italic"),options:{shortcut:"i"},states:{tags:["i","em"],css:{"font-style":"italic"}},events:{beforeToggleView:function(){if(Browser.firefox){var a=this.textarea.get("value"),b=a.replace(/<embed([^>]*)>/gi,"<tmpembed$1>").replace(/<em([^>]*)>/gi,"<i$1>").replace(/<tmpembed([^>]*)>/gi,"<embed$1>").replace(/<\/em>/gi,"</i>");a!=b&&this.textarea.set("value",b)}},attach:function(){if(Browser.firefox){var a=this.textarea.get("value"),b=a.replace(/<embed([^>]*)>/gi,"<tmpembed$1>").replace(/<em([^>]*)>/gi,"<i$1>").replace(/<tmpembed([^>]*)>/gi,"<embed$1>").replace(/<\/em>/gi,"</i>");a!=b&&(this.textarea.set("value",b),this.setContent(b))}}}},underline:{title:MooEditable.Locale.get("underline"),options:{shortcut:"u"},states:{tags:["u"],css:{"text-decoration":"underline"}},events:{beforeToggleView:function(){if(Browser.firefox||Browser.ie){var a=this.textarea.get("value"),b=a.replace(/<span style="text-decoration: underline;"([^>]*)>/gi,"<u$1>").replace(/<\/span>/gi,"</u>");a!=b&&this.textarea.set("value",b)}},attach:function(){if(Browser.firefox||Browser.ie){var a=this.textarea.get("value"),b=a.replace(/<span style="text-decoration: underline;"([^>]*)>/gi,"<u$1>").replace(/<\/span>/gi,"</u>");a!=b&&(this.textarea.set("value",b),this.setContent(b))}}}},strikethrough:{title:MooEditable.Locale.get("strikethrough"),options:{shortcut:"s"},states:{tags:["s","strike"],css:{"text-decoration":"line-through"}}},insertunorderedlist:{title:MooEditable.Locale.get("unorderedList"),states:{tags:["ul"]}},insertorderedlist:{title:MooEditable.Locale.get("orderedList"),states:{tags:["ol"]}},indent:{title:MooEditable.Locale.get("indent"),states:{tags:["blockquote"]}},outdent:{title:MooEditable.Locale.get("outdent")},undo:{title:MooEditable.Locale.get("undo"),options:{shortcut:"z"}},redo:{title:MooEditable.Locale.get("redo"),options:{shortcut:"y"}},unlink:{title:MooEditable.Locale.get("removeHyperlink")},createlink:{title:MooEditable.Locale.get("addHyperlink"),options:{shortcut:"l"},states:{tags:["a"]},dialogs:{alert:MooEditable.UI.AlertDialog.pass(MooEditable.Locale.get("selectTextHyperlink")),prompt:function(a){return MooEditable.UI.PromptDialog(MooEditable.Locale.get("enterURL"),"http://",function(b){a.execute("createlink",!1,b.trim())})}},command:function(){var a=this.selection,c=this.dialogs.createlink;if(a.isCollapsed()){var d=a.getNode();if("a"==d.get("tag")&&d.get("href")){a.selectNode(d);var e=c.prompt;e.el.getElement(".dialog-input").set("value",d.get("href")),e.open()}else c.alert.open()}else{var f=a.getText(),e=c.prompt;b.test(f)&&e.el.getElement(".dialog-input").set("value",f),e.open()}}},urlimage:{title:MooEditable.Locale.get("addImage"),options:{shortcut:"m"},dialogs:{prompt:function(a){return MooEditable.UI.PromptDialog(MooEditable.Locale.get("enterImageURL"),"http://",function(b){a.execute("insertimage",!1,b.trim())})}},command:function(){this.dialogs.urlimage.prompt.open()}},toggleview:{title:MooEditable.Locale.get("toggleView"),command:function(){"textarea"==this.mode?this.toolbar.enable():this.toolbar.disable("toggleview"),this.toggleView()}}},MooEditable.Actions.Settings={},Element.Properties.mooeditable={get:function(){return this.retrieve("MooEditable")}},Element.implement({mooEditable:function(a){var b=this.get("mooeditable");return b||(b=new MooEditable(this,a)),b}});var e=null,f=null,g=null;window.addEvent("mousedown:relay(.mooeditable-resizer)",function(a,b){a.preventDefault(),e=b.getPrevious(),"none"==e.getStyle("display")&&(e=e.getPrevious()),f=e.getSize().y,g=a.client.y,"IFRAME"==e.tagName&&e.setStyle("visibility","hidden"),window.addEvents({mousemove:h,mouseup:i})})})(),MooEditable.UI.MenuList=new Class({Implements:[Events,Options],options:{title:"",name:"","class":"",list:[]},initialize:function(a){this.setOptions(a),this.name=this.options.name,this.render()},toElement:function(){return this.el},render:function(){var a=this,b="";return this.options.list.each(function(a){b+='<option value="{value}" style="{style}">{text}</option>'.substitute(a)}),this.el=new Element("select",{"class":a.options["class"],title:a.options.title,tabindex:-1,html:b,styles:{height:"21px"},events:{change:a.change.bind(a)}}),this.disabled=!1,Browser.ie&&this.el.addEvents({mouseenter:function(){this.addClass("hover")},mouseleave:function(){this.removeClass("hover")}}),this},change:function(a){if(a.preventDefault(),!this.disabled){var b=a.target.value;this.action(b)}},action:function(){this.fireEvent("action",[this].concat(Array.from(arguments)))},enable:function(){return this.disabled?(this.disabled=!1,this.el.set("disabled",!1).removeClass("disabled").set({disabled:!1,opacity:1}),this):void 0},disable:function(){return this.disabled?void 0:(this.disabled=!0,this.el.set("disabled",!0).addClass("disabled").set({disabled:!0,opacity:.4}),this)},activate:function(a){if(!this.disabled){var b=0;return a&&this.options.list.each(function(c,d){c.value==a&&(b=d)}),this.el.selectedIndex=b,this}},deactivate:function(){return this.el.selectedIndex=0,this.el.removeClass("onActive"),this}}),MooEditable.Locale.define({blockFormatting:"Format de block",paragraph:"Paragraphe",heading1:"En-tête 1",heading2:"En-tête 2",heading3:"En-tête 3",heading4:"En-tête 4",alignLeft:"Align Left",alignRight:"Align Right",alignCenter:"Align Center",alignJustify:"Align Justify",removeFormatting:"Remove Formatting",insertHorizontalRule:"Insert Horizontal Rule"}),Object.append(MooEditable.Actions,{formatBlock:{title:MooEditable.Locale.get("blockFormatting"),type:"menu-list",options:{list:[{text:MooEditable.Locale.get("paragraph"),value:"p"},{text:MooEditable.Locale.get("heading2"),value:"h2",style:"font-size:18px; font-weight:bold;"},{text:MooEditable.Locale.get("heading3"),value:"h3",style:"font-size:14px; font-weight:bold;"},{text:MooEditable.Locale.get("heading4"),value:"h4",style:"font-size:12px; font-weight:bold;"}]},states:{tags:["p","h2","h3","h4"]},command:function(a,b){var c="<"+b+">";this.focus(),this.execute("formatBlock",!1,c)}},justifyleft:{title:MooEditable.Locale.get("alignLeft"),states:{css:{"text-align":"left"}},command:function(){var c=this.selection.getNode(),d=c.tagName;"IMG"==d||"OBJECT"==d?c.align="left":"P"==d&&(c.align="")}},justifyright:{title:MooEditable.Locale.get("alignRight"),states:{css:{"text-align":"right"}},command:function(){var c=this.selection.getNode(),d=c.tagName;"IMG"==d||"OBJECT"==d?c.align="right":"P"==d&&(c.align="right")}},justifycenter:{title:MooEditable.Locale.get("alignCenter"),states:{tags:["center"],css:{"text-align":"center"}}},justifyfull:{title:MooEditable.Locale.get("alignJustify"),states:{css:{"text-align":"justify"}}},removeformat:{title:MooEditable.Locale.get("removeFormatting")},insertHorizontalRule:{title:MooEditable.Locale.get("insertHorizontalRule"),states:{tags:["hr"]},command:function(){this.selection.insertContent("<hr>")}}}),MooEditable.UI.PasteDialog=new Class({Extends:MooEditable.UI.Dialog,initialize:function(a){this.editor=a,this.unique=Math.random(),this.dummy_el=new Element("div",{styles:{display:"none"}})
},toElement:function(){return this.dummy_el},close:function(){return this.adjust&&(this.adjust.destroy(),this.adjust=null),this.fireEvent("close",this),this},open:function(){if(this.adjust)return this.close();var a=this.editor,b=a.toolbar.items.paste.el,c=b.getCoordinates();adjust=new Element("div",{"class":"mooeditable-ui-dialog mooeditable-paste-dialog",styles:{position:"absolute",width:"64ex",left:c.left+c.width/2,"margin-left":"-32ex",top:c.bottom+20}}),this.adjust=adjust;var d,e,f=new Element("div",{"class":"mooeditable-ui-dialog-action-frame"});f.adopt(e=new Element("button.btn-primary",{type:"button",html:"Coller"}));var g=new Element("div",{"class":"mooeditable-ui-dialog-contents-frame"});g.adopt(d=new Element("textarea",{rows:10})),adjust.adopt(g,f),e.addEvent("click",function(){var c=d.get("value");c&&(c=c.replace(/\r?\n\r?\n/gi,"</p><p>"),c=c.replace(/\r?\n/gi,"<br />"),c="<p>"+c+"</p>",a.selection.insertContent(c)),this.close()}.bind(this)),document.body.appendChild(adjust),d.focus()}}),MooEditable.Actions.paste={title:"Paste text, stripping formating",dialogs:{prompt:function(a){return new MooEditable.UI.PasteDialog(a)}},command:function(){this.dialogs.paste.prompt.open()}},MooEditable=Class.refactor(MooEditable,{attach:function(){var a=this.previous();return this.doc.body.addListener("paste",this.cleanPaste.bind(this)),a},cleanPaste:function(a){var b=a.clipboardData&&a.clipboardData.getData?a.clipboardData.getData("text/html"):window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):!1;return b&&""!==b.trim()||!a.clipboardData||!a.clipboardData.getData||(b=a.clipboardData.getData("Text")),b?(window.clipboardData?this.selection.insertContent(this.cleanHtml(b,1)):this.selection.insertContent(this.cleanHtml(b)),a.preventDefault(),a.stopPropagation()):(this.selection.insertContent('<span id="INSERTION_MARKER">&nbsp;</span>'),this.txtMarked=this.doc.body.get("html"),this.doc.body.set("html",""),this.replaceMarkerWithPastedText.delay(5,this)),this},replaceMarkerWithPastedText:function(){var a=this.cleanHtml(this.doc.body.get("html"));return this.doc.body.set("html",this.txtMarked),this.selection.selectNode(this.doc.body.getElementById("INSERTION_MARKER")),this.selection.insertContent(a),this},cleanHtml:function(a,b){return a=a.replace(/<(\w+)([^>]*)>\s+/g,"<$1$2>\n"),a=a.replace(/>\s+</g,">\n<"),b?this.options.paragraphise?(a="<p>"+a+"</p>",a=a.replace(/\n\n/g,"</p><p>"),a=a.replace(/<p>\s<\/p>/gi,"")):a=a.replace(/\n/g,"<br />"):(a=a.replace(/<html[^>]*?>(.*)/gim,"$1"),a=a.replace(/<\/html>/gi,""),a=a.replace(/<body[^>]*?>(.*)/gi,"$1"),a=a.replace(/<\/body>/gi,""),a=a.replace(/<style[^>]*?>[\s\S]*?<\/style[^>]*>/gi,""),a=a.replace(/<(?:meta|link)[^>]*>\s*/gi,""),a=a.replace(/<\\?\?xml[^>]*>/gi,""),a=a.replace(/<w:[^>]*>[\s\S]*?<\/w:[^>]*>/gi,""),a=a.replace(/<o:p>\s*<\/o:p>/g,""),a=a.replace(/<o:p>[\s\S]*?<\/o:p>/g,"&nbsp;"),a=a.replace(/<\/?\w+:[^>]*>/gi,""),a=a.replace(/<\!--[\s\S]*?-->/g,""),a=a.replace(/<\!\[[\s\S]*?\]>/g,""),a=a.replace(/\s*mso-[^:]+:[^;"']+;?/gi,""),a=a.replace(/<(\w[^>]*) style='([^\']*)'([^>]*)/gim,"<$1$3"),a=a.replace(/<(\w[^>]*) style="([^\"]*)"([^>]*)/gim,"<$1$3"),a=a.replace(/\s*margin: 0cm 0cm 0pt\s*;/gi,""),a=a.replace(/\s*margin: 0cm 0cm 0pt\s*"/gi,'"'),a=a.replace(/\s*text-indent: 0cm\s*;/gi,""),a=a.replace(/\s*text-indent: 0cm\s*"/gi,'"'),a=a.replace(/\s*text-align: [^\s;]+;?"/gi,'"'),a=a.replace(/\s*page-break-before: [^\s;]+;?"/gi,'"'),a=a.replace(/\s*font-variant: [^\s;]+;?"/gi,'"'),a=a.replace(/\s*tab-stops:[^;"']*;?/gi,""),a=a.replace(/\s*tab-stops:[^"']*/gi,""),a=a.replace(/\s*face="[^"']*"/gi,""),a=a.replace(/\s*face=[^ >]*/gi,""),a=a.replace(/\s*font-family:[^;"']*;?/gi,""),a=a.replace(/\s*font-size:[^;"']*;?/gi,""),a=a.replace(/class="MsoNormal"/gi,""),a=a.replace(/<(\w+)[^>]*\sstyle="[^"']*display\s?:\s?none[\s \S]*?<\/\1>/gi,""),a=a.replace(/\s*style='\s*'/gi,""),a=a.replace(/\s*style="\s*"/gi,""),a=a.replace(/<span\s*[^>]*>\s*&nbsp;\s*<\/span>/gi,"&nbsp;"),a=a.replace(/<span\s*[^>]*><\/span>/gi,""),a=a.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3"),a=a.replace(/<(font|i|span|strike|u)(\s*>|\s+[^>]+>)/gi,""),a=a.replace(/<\/(font|i|span|strike|u)>/gi,""),a=a.replace(/<h\d>\s*<\/h\d>/gi,""),a=a.replace(/<(\w[^>]*) language=([^ |>]*)([^>]*)/gi,"<$1$3"),a=a.replace(/<(\w[^>]*) onmouseover="([^\"']*)"([^>]*)/gi,"<$1$3"),a=a.replace(/<(\w[^>]*) onmouseout="([^\"']*)"([^>]*)/gi,"<$1$3"),a=a.replace(/<h(\d)([^>]*)>/gi,"<h$1>"),a=a.replace(/<(h\d)><em>([\s\S]*?)<\/em><\/\1>/gi,"<$1>$2</$1>"),a=a.replace(/<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1</strong>"),a=a.replace(/<i\b[^>]*>(.*?)<\/i[^>]*>/gi,"<em>$1</em>"),a=a.replace(/<\s+[^>]*>/gi,""),a=a.trim(),a=a.replace(/<br>/gi,"<br />"),a=a.replace(/^(\s*<br \/>\s*)+|(\s*<br \/>\s*)+$/gi,""),a=a.replace(/(\s*<br \/>\s*)+<\/p>/gim,"</p>"),a=a.replace(/<(\w+)[^>]*>\s*&nbsp;\s*<\/\1>/gi,""),a=a.replace(/<p>\s<\/p>/gi,""),a=a.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,function(a,b){return b.match(/^iframe$/i)?a:""}),a=a.trim()),a=a.replace(/src="([^"]+)/gi,function(a,b){return b.match(/^(http:\/\/|\/)/)||(b=this.baseHREF+"/"+b),'src="'+b}.bind(this))}}),MooEditable.Actions.outline={title:"Outline blocks",command:function(){this.doc.body.toggleClass("mooeditable-outline")}},!function(){var a="iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRF////IiIiHNlGNAAAAAF0Uk5TAEDm2GYAAAAeSURBVHjaYmBkYMCPKJVnZBi1YtSKUSuGphUAAQYAxEkBVsmDp6QAAAAASUVORK5CYII=";MooEditable.UI.ImageDialog=new Class({Extends:MooEditable.UI.Dialog,initialize:function(a){this.editor=a,this.unique=Math.random(),this.dummy_el=new Element("div",{styles:{display:"none"}})},toElement:function(){return this.dummy_el},click:function(){return this.fireEvent("click",arguments),this},close:function(){return this.popover&&this.popover.hide(),this.fireEvent("close",this),this},open:function(){this.node=this.editor.selection.getNode(),this.node&&"img"==this.node.get("tag")||(this.node=this.editor.doc.createElement("img"),this.node.src="data:image/gif;base64,"+a,this.editor.selection.getRange().insertNode(this.node)),this.node.addEvent("load",function(){this.popover&&this.popover.reposition()}.bind(this)),this.previousImage=this.node.get("src"),this.popover?(this.popover.attachAnchor(this.node),this.popover.adjust.setValues(this.node),this.popover.show()):(this.fetchAdjustOperation||(this.fetchAdjustOperation=new Request.Widget("adjust-thumbnail/popup",this.setupPopover.bind(this))),this.fetchAdjustOperation.get({selected:this.node.get("data-nid")||this.node.src}))},setupPopover:function(a){this.popover=new Icybee.Widget.AdjustPopover(a,{anchor:this.node,iframe:this.editor.iframe}),this.popover.iframe=this.editor.iframe,this.popover.addEvent("action",function(a){var b=a.action,c=this.node.src;"cancel"==b?this.node.src=c=this.previousImage:"remove"==b&&(c=null),c&&"data:"!=c.substring(0,5)||(this.node.destroy(),delete this.node),this.close()}.bind(this)),this.popover.show(),this.popover.adjust.setValues(this.node),this.popover.adjust.addEvent("change",function(a){var b=a.options;this.node.src=this.editor.baseHREF+a.url,this.node.set("data-nid",a.nid),b.lightbox?this.node.set("data-lightbox",!0):this.node.removeAttribute("data-lightbox"),b.w&&"surface"!=b.method?this.node.set("width",b.w):this.node.removeAttribute("width"),b.h&&"surface"!=b.method?this.node.set("height",b.h):this.node.removeAttribute("height")}.bind(this))}}),MooEditable.Actions.image={title:"Add/Edit Image",options:{shortcut:"m"},dialogs:{prompt:function(a){return new MooEditable.UI.ImageDialog(a)}},command:function(){this.dialogs.image.prompt.open()}}}(),window.addEvent("brickrouge.update",function(){$$("textarea.moo").each(function(a){if(!a.retrieve("mooeditable")){var b=a.get("dataset");b.externalCss&&(b.externalCSS=JSON.decode(b.externalCss)),b.baseUrl&&(b.baseURL=b.baseUrl),a.mooEditable(b),a.store("mooeditable",!0)}})});